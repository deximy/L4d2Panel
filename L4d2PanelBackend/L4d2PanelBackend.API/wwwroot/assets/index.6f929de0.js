import{r as W,o as x,c as O,a as N,p as T,b as I,d as b,e as D,f as m,g as X,u as se,h as d,w as h,t as re,i,N as S,j as ae,k as ie,H as ue,U as ce,l as de,m as _e,n as M,q as U,v as j,s as V,x as pe,y as fe,z as Y,A as v,B as ve,C as me,D as he,E as we,F as z,G as ye,I as ge,J as be,K as J,L as xe,M as ke,O as Ee,P as Ce,Q as Fe,R as Se,S as De,T as F,V as Ne,W as Ae,X as Be,Y as $e,Z as Le,_ as Me,$ as Oe}from"./vendor.a0809b5e.js";const Te=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const e of r)if(e.type==="childList")for(const s of e.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function l(r){const e={};return r.integrity&&(e.integrity=r.integrity),r.referrerpolicy&&(e.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?e.credentials="include":r.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function o(r){if(r.ep)return;r.ep=!0;const e=l(r);fetch(r.href,e)}};Te();var k=(t,n)=>{const l=t.__vccOpts||t;for(const[o,r]of n)l[o]=r;return l};const Ie={};function Re(t,n){const l=W("router-view");return x(),O(l)}var He=k(Ie,[["render",Re]]);const Pe={},Q=t=>(T("data-v-0a38735b"),t=t(),I(),t),Ue={class:"logo"},je=Q(()=>b("h2",{class:"title"},"L4D2 Server Dashboard",-1)),Ve=Q(()=>b("span",null,"logo\u8FD8\u6CA1\u505A\u5148\u51D1\u5408\u4E00\u4E0B",-1)),ze=[je,Ve];function Ke(t,n){return x(),N("div",Ue,ze)}var Ge=k(Pe,[["render",Ke],["__scopeId","data-v-0a38735b"]]);const qe=t=>(T("data-v-1b1cc04d"),t=t(),I(),t),We={class:"switch_edition"},Xe={class:"switcher"},Ye=qe(()=>b("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 320 512"},[b("path",{d:"M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4l96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z",fill:"currentColor"})],-1)),Je=D({setup(t){const n=m("professional"),l=[{label:"\u6807\u51C6\u7248",value:"standard",disabled:!0},{label:"\u9AD8\u7EA7\u7248",value:"premium",disabled:!0},{label:"\u4E13\u4E1A\u7248",value:"professional"}],o=s=>{if(s!=="professional"){e.error("\u522B\u770B\u4E86\u4E0D\u652F\u6301\u8FD9\u4E2A");return}n.value=s},r=X(()=>{for(let s of l)if(s.value===n.value)return s.label}),e=se();return(s,f)=>(x(),N("div",We,[d(i(ae),{value:n.value,"onUpdate:value":[f[0]||(f[0]=y=>n.value=y),o],options:l,size:"small"},{default:h(()=>[b("div",Xe,[b("span",null,re(i(r)),1),d(i(S),null,{default:h(()=>[Ye]),_:1})])]),_:1},8,["value"])]))}});var Qe=k(Je,[["__scopeId","data-v-1b1cc04d"]]);const w=ie("store",()=>{const t=m(""),n=m(""),l=m(!1),o=m(""),r=m(""),e=m("./");return{endpoint:t,component:n,is_server_running:l,selected_file_name:o,selected_file_type:r,current_path:e}}),Ze=async()=>{const t=w();let n="http://"+t.endpoint+"/processes";await fetch(n,{method:"POST"})},et=async()=>{const t=w();let n="http://"+t.endpoint+"/processes";await fetch(n,{method:"PATCH"})},tt=async t=>{const n=w();let l="http://"+n.endpoint+"/processes/command",o=new FormData;o.append("command",t),await fetch(l,{method:"POST",body:o})},nt=async()=>{const t=w();let n="http://"+t.endpoint+"/processes/",l=await(await fetch(n,{method:"GET"})).json();return l.length==0?!1:(n+=l[0],(await(await fetch(n,{method:"GET"})).json()).exit_time===null)};setInterval(()=>{nt().then(t=>w().is_server_running=t)},1e3);const ot=async()=>{const t=w();let n="http://"+t.endpoint+"/hub";return new ue().withUrl(n).build()},lt=async t=>{const n=w();let l="http://"+n.endpoint+"/files/"+t;return await(await fetch(l)).json()},K=async t=>{const n=w();let l="http://"+n.endpoint+"/files/"+t;return await fetch(l,{method:"POST"})},G=async(t,n,l,o)=>{const r=w();let e="http://"+r.endpoint+"/upload",s=new ce(t,{endpoint:e,retryDelays:[0,3e3,5e3,1e4,2e4],metadata:{name:t.name,contentType:t.type||"application/octet-stream",emptyMetaKey:"",location:n},onError:function(f){console.log("Failed because: "+f),o()},onProgress:function(f,y){let c=(f/y*100).toFixed(2);console.log(s.file.name,f,y,c+"%")},onSuccess:function(){console.log("Succeed. Download %s from %s",s.file.name,s.url),l()}});s.findPreviousUploads().then(function(f){f.length&&s.resumeFromPreviousUpload(f[0]),s.start()})},q=async t=>{const n=w();let l="http://"+n.endpoint+"/files/"+t;return await fetch(l,{method:"DELETE"})};const st={class:"side_menu"},rt=Y(" \u542F\u52A8 "),at=Y(" \u505C\u6B62 "),it=D({setup(t){var f;const n=de(),l=_e(),o=m((f=l.name)==null?void 0:f.toString());M(o,y=>{n.push(`/${l.params.endpoint}/${String(y)}`)});const r=[{key:"file",label:"\u6587\u4EF6\u7BA1\u7406",icon:()=>v(S,null,{default:()=>[v("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},v("path",{d:"M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z",fill:"currentColor"}))]})},{key:"terminal",label:"\u63A7\u5236\u53F0",icon:()=>v(S,null,{default:()=>[v("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},v("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[v("path",{d:"M5 7l5 5l-5 5"}),v("path",{d:"M12 19h7"})]))]})}],e=m(!1),s=m(!1);return M(()=>w().is_server_running,y=>{e.value=y,s.value=!1}),(y,c)=>(x(),N("div",st,[U(d(i(V),{class:"control_button",strong:"",secondary:"",type:"primary",loading:s.value,onClick:c[0]||(c[0]=_=>{i(Ze)(),s.value=!0})},{default:h(()=>[rt]),_:1},8,["loading"]),[[j,!e.value]]),U(d(i(V),{class:"control_button",strong:"",secondary:"",type:"error",loading:s.value,onClick:c[1]||(c[1]=_=>{i(et)(),s.value=!0})},{default:h(()=>[at]),_:1},8,["loading"]),[[j,e.value]]),d(i(pe)),d(i(fe),{options:r,value:o.value,"onUpdate:value":c[2]||(c[2]=_=>o.value=_)},null,8,["value"])]))}});var ut=k(it,[["__scopeId","data-v-6307a47d"]]);const ct=t=>(T("data-v-92666210"),t=t(),I(),t),dt=ct(()=>b("span",{style:{color:"#66CCFF"}},"\u8FD9\u91CC\u597D\u50CF\u5E94\u8BE5\u5199\u70B9\u4EC0\u4E48\uFF0C\u4F46\u6211\u61D2\u5F97\u60F3\u4E86\u3002",-1)),_t=D({setup(t){return(n,l)=>{const o=W("router-view");return x(),O(i(z),{class:"dashboard","content-style":"display: flex; flex-direction: column;"},{default:h(()=>[d(i(me),{class:"header",bordered:!0},{default:h(()=>[d(Ge),d(i(ve),null,{default:h(()=>[d(Qe)]),_:1})]),_:1}),d(i(z),{class:"content","has-sider":!0},{default:h(()=>[d(i(he),null,{default:h(()=>[d(ut)]),_:1}),d(i(we),null,{default:h(()=>[d(o,{onOnCommitCommand:i(tt)},null,8,["onOnCommitCommand"])]),_:1})]),_:1}),d(i(ye),{class:"footer"},{default:h(()=>[dt]),_:1})]),_:1})}}});var pt=k(_t,[["__scopeId","data-v-92666210"]]);const ft=D({emits:["OnCommitCommand"],setup(t,{emit:n}){const l=m();let o="",r=new Array;const e=new ge.exports.Terminal({rendererType:"canvas",convertEol:!0,disableStdin:!1,cursorBlink:!0,scrollback:0}),s=new be.exports.FitAddon;e.loadAddon(s),e.onKey(c=>{const _=c.domEvent,A=!_.altKey&&!_.ctrlKey&&!_.metaKey;if(console.log(_.code,e.buffer),_.code==="Enter"||_.code==="NumpadEnter"){if(o.replace(/^\s+|\s+$/g,"").length!=0){n("OnCommitCommand",o),r.push(o);for(let B of o)e.write("\b \b");o=""}}else _.code==="Backspace"?(e.write("\b \b"),o=o.slice(0,o.length-1)):_.code==="ArrowLeft"?e.write(c.key):_.code==="ArrowRight"?e.buffer.active.cursorX<o.length&&e.write(c.key):A&&(e.write(c.key),o+=c.key)}),ot().then(c=>{c.on("ReceiveMessage",_=>{e.writeln(_)}),c==null||c.start().then(()=>{}).catch(_=>{console.log(_)})});let f=new ResizeObserver(()=>{J().then(()=>{s.fit()})});xe(()=>{if(l.value===void 0)throw new Error("Cannot find terminal element!");e.open(l.value),f.observe(l.value)}),ke(()=>{f.disconnect()});const y=X(()=>w().is_server_running);return(c,_)=>(x(),O(i(Ee),{class:"loading",show:!i(y),stroke:"#66CCFF"},{default:h(()=>[b("div",{class:"terminal",ref_key:"terminal_element",ref:l},null,512)]),_:1},8,["show"]))}});var vt=k(ft,[["__scopeId","data-v-f1276280"]]);const mt={class:"file_manager"},ht=D({setup(t){const n=w(),l=[{key:"file_type",fixed:"left",width:"0",className:"file_type_icon",render:a=>a.file_type==="directory"?v("div",{class:"file_type_icon_wrapper"},v(S,{},{default:()=>[v("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},v("path",{d:"M10.59 4.59C10.21 4.21 9.7 4 9.17 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-1.41-1.41z",fill:"currentColor"}))]})):v("div",{class:"file_type_icon_wrapper"},v(S,{},{default:()=>[v("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},v("path",{d:"M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z",fill:"currentColor"}))]}))},{title:"\u6587\u4EF6\u540D",key:"file_name",className:"file_name"}],o=m([]),r=a=>({onDblclick:u=>{a.file_type==="directory"?f(a.file_name):a.file_type==="file"?y(a.file_name):console.error("Unknown file type!")},onContextmenu:u=>{u.preventDefault(),E.value=!1,n.selected_file_type=a.file_type,n.selected_file_name=a.file_name,B.value=u.clientX,H.value=u.clientY,J().then(()=>{E.value=!0})}});let{current_path:e}=Ce(n);const s=async a=>{let u=await lt(a);if(u===void 0){console.log("Empty response!");return}o.value.length=0,o.value.push({key:"directory_..",file_type:"directory",file_name:".."});for(let p of u.directories)o.value.push({key:"directory_"+p,file_type:"directory",file_name:p});for(let p of u.files)o.value.push({key:"file_"+p,file_type:"file",file_name:p})},f=async a=>{e.value=F.join(e.value,a),e.value.startsWith("..")&&(e.value="./")},y=async a=>{console.log("Try to open file: "+a)},c=()=>{$.value=!0},_=async a=>{await q(F.join(e.value,a)),await s(e.value)},A=async a=>{await q(F.join(e.value,a)),await s(e.value)};M(e,a=>{s(a)}),s(e.value);const B=m(0),H=m(0),Z=[{label:"\u5237\u65B0",key:"refresh"},{label:"\u65B0\u5EFA\u6587\u4EF6\u5939",key:"mkdir"},{label:"\u4E0A\u4F20\u6587\u4EF6",key:"upload_file"},{label:"\u4E0A\u4F20\u6587\u4EF6\u5939",key:"upload_directory"},{label:()=>v("span",{style:{color:"red"}},"\u5220\u9664"),key:"delete"}],E=m(!1),ee=()=>{E.value=!1},te=(a,u)=>{if(E.value=!1,u==="refresh")s(e.value);else if(u==="mkdir")c();else if(u==="upload_file"){let p=document.getElementsByClassName("n-upload-file-input");if(p.length==0)throw new RangeError("Couldn't find file input!");p[0].removeAttribute("webkitdirectory"),a()}else if(u==="upload_directory"){let p=document.getElementsByClassName("n-upload-file-input");if(p.length==0)throw new RangeError("Couldn't find file input!");p[0].setAttribute("webkitdirectory","webkitdirectory"),a()}else u==="delete"?n.selected_file_type==="directory"?_(n.selected_file_name):n.selected_file_type==="file"?A(n.selected_file_name):console.error("Unknown file type:"+n.selected_file_type):console.error("Unknown key: "+u)},ne=({file:a,onFinish:u,onError:p})=>{let g=a.file;if(g.webkitRelativePath!=""&&g.webkitRelativePath!=null){let le=g.webkitRelativePath.substring(0,g.webkitRelativePath.lastIndexOf("/")),P=F.join(e.value,le);K(P).then(()=>{G(g,P,u,p).then(()=>s(e.value))})}else G(g,e.value,u,p).then(()=>s(e.value))},$=m(!1),oe=()=>{C.value!=null&&(K(F.join(e.value,C.value)).then(()=>s(e.value)),C.value=null)},C=m(null);return(a,u)=>(x(),N("div",mt,[d(i(Fe),{class:"file_list",bordered:!1,columns:l,data:o.value,"row-props":r},null,8,["data"]),d(i(Se),{abstract:"",multiple:!0,"custom-request":ne},{default:h(()=>[d(i(Ne),{abstract:""},{default:h(({handleClick:p})=>[d(i(Ae),{placement:"bottom-start",trigger:"manual",x:B.value,y:H.value,options:Z,show:E.value,onClickoutside:ee,onSelect:g=>te(p,g)},null,8,["x","y","show","onSelect"])]),_:1})]),_:1}),d(i(De),{show:$.value,"onUpdate:show":u[1]||(u[1]=p=>$.value=p),preset:"dialog",title:"\u65B0\u5EFA\u6587\u4EF6\u5939","show-icon":!1,"negative-text":"\u53D6\u6D88","positive-text":"\u786E\u8BA4","on-positive-click":oe},{default:h(()=>[d(i(Be),{value:C.value,"onUpdate:value":u[0]||(u[0]=p=>C.value=p),type:"text",placeholder:"\u6587\u4EF6\u5939\u540D"},null,8,["value"])]),_:1},8,["show"])]))}});var wt=k(ht,[["__scopeId","data-v-8a957014"]]);const yt=[{path:"/:endpoint",component:pt,beforeEnter:t=>{if(typeof t.params.endpoint!="string")throw console.error(t.params.endpoint),new Error("Unable to resolve endpoint.");L.endpoint=t.params.endpoint},children:[{path:"terminal",name:"terminal",component:vt,beforeEnter:()=>{L.component="terminal"}},{path:"file",name:"file",component:wt,beforeEnter:()=>{L.component="file"}},{path:":path(.*)*",redirect:{name:"terminal"}}]}],gt=$e({history:Le(),routes:yt}),bt=Me(),R=Oe(He);R.use(gt);R.use(bt);R.mount("#app");const L=w();
